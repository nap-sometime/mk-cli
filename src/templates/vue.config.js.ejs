const path = require('path');
<%_ if (props.wantHttps) { _%>
const { readFileSync } = require('fs');
<%_ } _%>
const { name: npm_package_name } = require('./package.json');

process.env.VUE_APP_NAME = npm_package_name;

module.exports = {
	lintOnSave: false,
	filenameHashing: false,
	productionSourceMap: false,
	configureWebpack: {
		output: {
			path: path.resolve(__dirname, 'dist'),
			chunkFilename: 'js/[name].bundle.js',
		},
		externals: ['vue', 'vue-router', 'vue-meta', /^@mk\/.+/],
		resolve: {
			alias: {
				'@': path.resolve(__dirname, 'src'),
				'~': path.resolve(__dirname, 'src'),
			},
		},
		devServer: {
			headers: {
				'Access-Control-Allow-Origin': '*',
			},
			disableHostCheck: true,
			sockPort: 8001,
			sockHost: 'localhost',
			port: 8001,
			<%_ if (props.wantHttps) { _%>
			https: {
				cert: readFileSync(path.join(__dirname, '<%= props.httpsCertPath.trim() %>')),
				key: readFileSync(path.join(__dirname, '<%= props.httpsKeyPath.trim() %>')),
			},
			<%_ } _%>
		},
	},
};
